<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{base :: head-resources}"></head>
<body>
<div th:replace="~{base :: layout(~{::content})}">
    <div th:fragment="content">

        <h2 class="my-4">üìö Danh s√°ch Kho√° h·ªçc</h2>
        <a th:href="@{/admin/courses/add}" class="btn btn-success mb-3">‚ûï Th√™m Kho√° h·ªçc</a>

        <!-- Form t√¨m ki·∫øm & l·ªçc -->
        <form class="row g-3 mb-4" method="get" th:action="@{/admin/courses}">
            <!-- T·ª´ kho√° -->
            <div class="col-md-3">
                <input type="text" name="kw" class="form-control"
                       th:value="${param.kw}" placeholder="T√¨m theo ti√™u ƒë·ªÅ, m√¥ t·∫£..."/>
            </div>

            <!-- Tr·∫°ng th√°i -->
            <div class="col-md-2">
                <select name="status" class="form-select">
                    <option value="">-- Tr·∫°ng th√°i --</option>
                    <option value="DRAFT" th:selected="${param.status == 'DRAFT'}">Nh√°p</option>
                    <option value="PUBLISHED" th:selected="${param.status == 'PUBLISHED'}">ƒê√£ xu·∫•t b·∫£n</option>
                    <option value="ARCHIVED" th:selected="${param.status == 'ARCHIVED'}">ƒê√£ l∆∞u tr·ªØ</option>
                </select>
            </div>

            <!-- Danh m·ª•c -->
            <div class="col-md-2">
                <select name="categoryId" class="form-select">
                    <option value="">-- Danh m·ª•c --</option>
                    <option th:each="cat : ${categories}"
                            th:value="${cat.id}"
                            th:selected="${param.categoryId == cat.id}"
                            th:text="${cat.name}"></option>
                </select>
            </div>

<!--             Gi·∫£ng vi√™n 
            <div class="col-md-2">
                <select name="instructorId" class="form-select">
                    <option value="">-- Gi·∫£ng vi√™n --</option>
                    <option th:each="i : ${instructors}"
                            th:value="${i.id}"
                            th:selected="${param.instructorId == i.id}"
                            th:text="${i.fullName}"></option>
                </select>
            </div>-->

            <!-- N√∫t l·ªçc -->
            <div class="col-md-2">
                <button type="submit" class="btn btn-primary w-100">üîç L·ªçc</button>
            </div>
        </form>

        <!-- B·∫£ng danh s√°ch -->
        <table class="table table-bordered table-hover shadow">
            <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Ti√™u ƒë·ªÅ</th>
                <th>Danh m·ª•c</th>
                <th>Gi·∫£ng vi√™n</th>
                <th>Tr·∫°ng th√°i</th>
                <th>Ng√†y t·∫°o</th>
                <th>Thao t√°c</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="c : ${courses}">
                <td th:text="${c.id}"></td>
                <td th:text="${c.title}"></td>
                <td th:text="${c.categoryId != null ? c.categoryId.name : '---'}"></td>
                <td th:text="${c.instructorId != null ? c.instructorId.fullName : '---'}"></td>
                <td th:text="${c.status}"></td>
                <td th:text="${#dates.format(c.createdAt, 'dd/MM/yyyy')}"></td>
                <td>
                    <a th:href="@{/admin/courses/{id}/sections(id=${c.id})}"
                       class="btn btn-sm btn-primary">üìñ Sections</a>
                    <a th:href="@{/admin/courses/{id}/edit(id=${c.id})}"
                       class="btn btn-sm btn-warning">‚úè S·ª≠a</a>
                    <a th:href="@{/admin/courses/{id}/delete(id=${c.id})}"
                       class="btn btn-sm btn-danger"
                       onclick="return confirm('Xo√° kho√° h·ªçc n√†y?')">üóë Xo√°</a>
                </td>
            </tr>
            <tr th:if="${#lists.isEmpty(courses)}">
                <td colspan="7" class="text-center text-muted">Kh√¥ng c√≥ kho√° h·ªçc n√†o</td>
            </tr>
            </tbody>
        </table>

        <!-- Ph√¢n trang -->
        <nav th:if="${count > pageSize}">
            <ul class="pagination">
                <li class="page-item" th:classappend="${page == 1}? 'disabled'">
                    <a class="page-link"
                       th:href="@{/admin/courses(page=${page-1}, kw=${param.kw}, status=${param.status}, categoryId=${param.categoryId}, instructorId=${param.instructorId})}">¬´</a>
                </li>
                <li class="page-item"
                    th:each="i : ${#numbers.sequence(1, (count + pageSize - 1) / pageSize)}"
                    th:classappend="${i == page}? 'active'">
                    <a class="page-link"
                       th:href="@{/admin/courses(page=${i}, kw=${param.kw}, status=${param.status}, categoryId=${param.categoryId}, instructorId=${param.instructorId})}"
                       th:text="${i}"></a>
                </li>
                <li class="page-item" th:classappend="${page * pageSize >= count}? 'disabled'">
                    <a class="page-link"
                       th:href="@{/admin/courses(page=${page+1}, kw=${param.kw}, status=${param.status}, categoryId=${param.categoryId}, instructorId=${param.instructorId})}">¬ª</a>
                </li>
            </ul>
        </nav>

    </div>
</div>
</body>
</html>
