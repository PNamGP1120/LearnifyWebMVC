<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{base :: head-resources}"></head>
<body>
<div th:replace="~{base :: layout(~{::content})}">
  <div th:fragment="content">

    <h2 class="my-4">๐ Danh sรกch Enrollments</h2>
    <a th:href="@{/admin/enrollments/add}" class="btn btn-success mb-3">โ Thรชm Enrollment</a>

    <!-- Form lแปc / tรฌm kiแบฟm -->
    <form class="row g-3 mb-4" method="get" th:action="@{/admin/enrollments}">
      <div class="col-md-3">
        <input type="text" name="studentId" class="form-control"
               th:value="${param.studentId}" placeholder="ID hแปc viรชn"/>
      </div>
      <div class="col-md-3">
        <input type="text" name="courseId" class="form-control"
               th:value="${param.courseId}" placeholder="ID khoรก hแปc"/>
      </div>
      <div class="col-md-3">
        <select name="accessStatus" class="form-select">
          <option value="">-- Trแบกng thรกi --</option>
          <option value="ACTIVE" th:selected="${param.accessStatus == 'ACTIVE'}">ACTIVE</option>
          <option value="CANCELLED" th:selected="${param.accessStatus == 'CANCELLED'}">CANCELLED</option>
          <option value="COMPLETED" th:selected="${param.accessStatus == 'COMPLETED'}">COMPLETED</option>
        </select>
      </div>
      <div class="col-md-3">
        <button type="submit" class="btn btn-primary w-100">๐ Lแปc</button>
      </div>
    </form>

    <!-- Bแบฃng danh sรกch -->
    <table class="table table-bordered table-hover shadow">
      <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Hแปc viรชn</th>
        <th>Khoรก hแปc</th>
        <th>Ngรy ฤฤng kรฝ</th>
        <th>Trแบกng thรกi</th>
        <th>Thao tรกc</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="e : ${enrollments}">
        <td th:text="${e.id}"></td>
        <td th:text="${e.studentId != null ? e.studentId.fullName : '---'}"></td>
        <td th:text="${e.courseId != null ? e.courseId.title : '---'}"></td>
        <td th:text="${#dates.format(e.enrolledAt, 'dd/MM/yyyy')}"></td>
        <td th:text="${e.accessStatus}"></td>
        <td>
          <a th:href="@{/admin/enrollments/{id}(id=${e.id})}" class="btn btn-sm btn-primary">๐ Xem</a>
          <a th:href="@{/admin/enrollments/{id}/delete(id=${e.id})}"
             class="btn btn-sm btn-danger"
             onclick="return confirm('Xoรก enrollment nรy?')">๐ Xoรก</a>
        </td>
      </tr>
      <tr th:if="${#lists.isEmpty(enrollments)}">
        <td colspan="6" class="text-center text-muted">Khรดng tรฌm thแบฅy enrollment nรo</td>
      </tr>
      </tbody>
    </table>

    <!-- Phรขn trang -->
    <nav th:if="${count > pageSize}">
      <ul class="pagination">
        <li class="page-item" th:classappend="${page == 1}? 'disabled'">
          <a class="page-link"
             th:href="@{/admin/enrollments(page=${page-1}, studentId=${param.studentId}, courseId=${param.courseId}, accessStatus=${param.accessStatus})}">ยซ</a>
        </li>
        <li class="page-item"
            th:each="i : ${#numbers.sequence(1, (count + pageSize - 1) / pageSize)}"
            th:classappend="${i == page}? 'active'">
          <a class="page-link"
             th:href="@{/admin/enrollments(page=${i}, studentId=${param.studentId}, courseId=${param.courseId}, accessStatus=${param.accessStatus})}"
             th:text="${i}"></a>
        </li>
        <li class="page-item" th:classappend="${page * pageSize >= count}? 'disabled'">
          <a class="page-link"
             th:href="@{/admin/enrollments(page=${page+1}, studentId=${param.studentId}, courseId=${param.courseId}, accessStatus=${param.accessStatus})}">ยป</a>
        </li>
      </ul>
    </nav>

  </div>
</div>
</body>
</html>
